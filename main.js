/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var b=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var D=(p,i)=>{for(var t in i)b(p,t,{get:i[t],enumerable:!0})},k=(p,i,t,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of L(i))!x.call(p,s)&&s!==t&&b(p,s,{get:()=>i[s],enumerable:!(e=E(i,s))||e.enumerable});return p};var A=p=>k(b({},"__esModule",{value:!0}),p);var N={};D(N,{default:()=>T});module.exports=A(N);var d=require("obsidian");var w={defaultCalloutType:"note",rememberLastType:!1,autoFocusContent:!0,lastUsedType:"note",scanSnippets:!0},f=[{type:"note",label:"Note",icon:"lucide-pencil",color:"var(--callout-default)",source:"builtin",aliases:[]},{type:"abstract",label:"Abstract",icon:"lucide-clipboard-list",color:"var(--callout-summary)",source:"builtin",aliases:["summary","tldr"]},{type:"info",label:"Info",icon:"lucide-info",color:"var(--callout-info)",source:"builtin",aliases:[]},{type:"todo",label:"Todo",icon:"lucide-check-circle-2",color:"var(--callout-todo)",source:"builtin",aliases:[]},{type:"important",label:"Important",icon:"lucide-flame",color:"var(--callout-important)",source:"builtin",aliases:[]},{type:"tip",label:"Tip",icon:"lucide-flame",color:"var(--callout-tip)",source:"builtin",aliases:["hint"]},{type:"success",label:"Success",icon:"lucide-check",color:"var(--callout-success)",source:"builtin",aliases:["check","done"]},{type:"question",label:"Question",icon:"lucide-help-circle",color:"var(--callout-question)",source:"builtin",aliases:["help","faq"]},{type:"warning",label:"Warning",icon:"lucide-alert-triangle",color:"var(--callout-warning)",source:"builtin",aliases:["caution","attention"]},{type:"failure",label:"Failure",icon:"lucide-x",color:"var(--callout-fail)",source:"builtin",aliases:["fail","missing"]},{type:"danger",label:"Danger",icon:"lucide-zap",color:"var(--callout-error)",source:"builtin",aliases:["error"]},{type:"bug",label:"Bug",icon:"lucide-bug",color:"var(--callout-bug)",source:"builtin",aliases:[]},{type:"example",label:"Example",icon:"lucide-list",color:"var(--callout-example)",source:"builtin",aliases:[]},{type:"quote",label:"Quote",icon:"lucide-quote",color:"var(--callout-quote)",source:"builtin",aliases:["cite"]}];var u=require("obsidian");var m=class extends u.Modal{constructor(t,e){var o,n;super(t);this.config=e;this.title="";this.content="";this.collapse="none";this.builtinOptions=[];this.snippetOptions=[];this.allCalloutOptions=[];this.type=e.defaultType,this.autoFocusContent=e.autoFocusContent,this.containerEl.addClass("insert-callout-modal"),this.prepareCalloutOptions();let s=this.getEditor();if(s){let a=s.getSelection();a&&(this.content=a)}this.allCalloutOptions.find(a=>a.type===this.type)||(this.type=(n=(o=this.allCalloutOptions[0])==null?void 0:o.type)!=null?n:"note")}getEditor(){var t,e;return(e=(t=this.app.workspace.getActiveViewOfType(u.MarkdownView))==null?void 0:t.editor)!=null?e:null}prepareCalloutOptions(){this.snippetOptions=[...this.config.snippetTypes];for(let t of f)if(this.builtinOptions.push({type:t.type,label:t.label,icon:t.icon,color:t.color,source:"builtin"}),t.aliases)for(let e of t.aliases)this.builtinOptions.push({type:e,label:`${t.label} (${e})`,icon:t.icon,color:t.color,source:"builtin"});this.allCalloutOptions=[...this.snippetOptions,...this.builtinOptions]}onOpen(){this.display()}display(){let{contentEl:t}=this;t.empty(),t.addEventListener("keydown",o=>{o.key==="Enter"&&(o.ctrlKey||o.metaKey)&&(o.preventDefault(),this.insertButton&&this.insertButton.click())});let e=t.createDiv("callout-type-container");this.iconContainerEl=e.createDiv("callout-icon-container"),new u.Setting(e).setName("Callout type").addDropdown(o=>{var l,c;let n=o.selectEl;if(this.snippetOptions.length>0){let r=n.createEl("optgroup",{attr:{label:"Custom"}});for(let h of this.snippetOptions)r.createEl("option",{value:h.type,text:h.label})}let a=n.createEl("optgroup",{attr:{label:"Default"}});for(let r of this.builtinOptions)a.createEl("option",{value:r.type,text:r.label});this.allCalloutOptions.some(r=>r.type===this.type)||(this.type=(c=(l=this.allCalloutOptions[0])==null?void 0:l.type)!=null?c:"note"),o.setValue(this.type),o.onChange(r=>{this.type=r,this.updateIconAndColor(this.iconContainerEl,r)})}),this.updateIconAndColor(this.iconContainerEl,this.type),new u.Setting(t).setName("Title").setDesc("Optional, leave blank for default title").addText(o=>{o.setPlaceholder("Input title").setValue(this.title).onChange(n=>{this.title=n})}),new u.Setting(t).setName("Collapse state").addDropdown(o=>{o.addOption("none","Default").addOption("open","Open").addOption("closed","Closed").setValue(this.collapse).onChange(n=>{this.collapse=n})}),new u.Setting(t).setName("Content").addTextArea(o=>{o.setPlaceholder("Input content").setValue(this.content).onChange(n=>{this.content=n}),o.inputEl.rows=5,o.inputEl.cols=40,this.contentTextArea=o.inputEl}),t.createDiv("insert-callout-shortcut-hint").setText(`${u.Platform.isMacOS?"\u2318":"Ctrl"} + Enter to insert`),new u.Setting(t).addButton(o=>(o.setButtonText("Insert").setCta().onClick(()=>{this.insertCallout(),this.close()}),this.insertButton=o.buttonEl,o)).addButton(o=>(o.setButtonText("Cancel").setTooltip("Cancel").onClick(()=>this.close()),o)),this.autoFocusContent&&setTimeout(()=>{this.contentTextArea&&this.contentTextArea.focus()},10)}updateIconAndColor(t,e){if(!t)return;let s=this.allCalloutOptions.find(o=>o.type===e);t.empty(),s?((0,u.setIcon)(t,s.icon),t.style.setProperty("--callout-color",s.color)):((0,u.setIcon)(t,"lucide-alert-circle"),t.style.removeProperty("--callout-color"))}insertCallout(){let t=this.getEditor();if(!t)return;let e=`> [!${this.type}]`;this.collapse!=="none"&&(e+=this.collapse==="open"?"+":"-"),this.title&&(e+=` ${this.title}`),e+=`
> ${this.content.replace(/\n/g,`
> `)}`;let s=t.getCursor(),o=t.getLine(s.line),n=s.ch===0,a;if(t.getSelection()){!n&&o.trim().length>0&&(e=`
`+e);let l=t.getCursor("from");t.replaceSelection(e);let c=e.split(`
`).length;a={line:l.line+c,ch:0}}else{!n&&o.trim().length>0&&(e=`
`+e),t.replaceRange(e,s);let l=e.split(`
`).length;a={line:s.line+l,ch:0}}setTimeout(()=>{t.replaceRange(`
`,a),t.setCursor({line:a.line+1,ch:0}),t.focus()},0)}};var y=require("obsidian");var C=class extends y.SuggestModal{constructor(t,e,s){super(t);this.allCalloutOptions=[];this.onChoose=s,this.setPlaceholder("Choose a callout type..."),this.prepareCalloutOptions(e)}prepareCalloutOptions(t){for(let e of t)this.allCalloutOptions.push(e);for(let e of f)if(this.allCalloutOptions.push(e),e.aliases)for(let s of e.aliases)this.allCalloutOptions.push({type:s,label:`${e.label} (${s})`,icon:e.icon,color:e.color,source:"builtin"})}getSuggestions(t){let e=t.toLowerCase();return e?this.allCalloutOptions.filter(s=>s.type.toLowerCase().includes(e)||s.label.toLowerCase().includes(e)):this.allCalloutOptions}renderSuggestion(t,e){let s=e.createDiv({cls:"quick-pick-callout-item"}),o=s.createDiv({cls:"quick-pick-callout-icon"});(0,y.setIcon)(o,t.icon),o.style.setProperty("--callout-color",t.color),s.createDiv({cls:"quick-pick-callout-label",text:t.label}),t.source!=="builtin"&&s.createDiv({cls:"quick-pick-callout-source",text:t.source})}onChooseSuggestion(t){this.onChoose(t.type)}static insertQuickCallout(t,e){var c,r;let s=(r=(c=t.workspace.getActiveViewOfType(y.MarkdownView))==null?void 0:c.editor)!=null?r:null;if(!s)return;let o=`> [!${e}]
> `,n=s.getCursor(),a=s.getLine(n.line),l=n.ch===0;if(s.getSelection()){let h=s.getSelection();o=`> [!${e}]
> ${h.replace(/\n/g,`
> `)}`,!l&&a.trim().length>0&&(o=`
`+o);let g=s.getCursor("from");s.replaceSelection(o);let O=o.split(`
`).length,v={line:g.line+O,ch:0};setTimeout(()=>{s.replaceRange(`
`,v),s.setCursor({line:v.line+1,ch:0}),s.focus()},0)}else{!l&&a.trim().length>0&&(o=`
`+o),s.replaceRange(o,n);let h=o.split(`
`).length;setTimeout(()=>{s.setCursor({line:n.line+h-1,ch:2}),s.focus()},0)}}};async function I(p){let i=[],t=new Set;for(let l of f)if(t.add(l.type),l.aliases)for(let c of l.aliases)t.add(c);let s=p.customCss.enabledSnippets,o=`${p.vault.configDir}/snippets`,n;try{n=await p.vault.adapter.list(o)}catch(l){return i}let a=n.files.filter(l=>{var h;if(!l.endsWith(".css"))return!1;let r=((h=l.split("/").pop())!=null?h:"").replace(/\.css$/,"");return s.has(r)});for(let l of a){let c;try{c=await p.vault.adapter.read(l)}catch(r){continue}P(c,i,t)}return i}function P(p,i,t){let e=/\.callout\[data-callout=["']([^"']+)["']\]\s*\{([^}]*)}/g,s;for(;(s=e.exec(p))!==null;){let o=s[1],n=s[2];if(!o||!n||t.has(o)||i.some(g=>g.type===o))continue;let a=n.match(/--callout-color:\s*([\d\s,]+)/),l=a&&a[1]?a[1].trim():"var(--callout-default)",c=n.match(/--callout-icon:\s*([\w-]+)/),r=c&&c[1]?c[1]:"lucide-box",h=o.replace(/[-_]/g," ").replace(/\b\w/g,g=>g.toUpperCase());i.push({type:o,label:h,icon:r,color:l,source:"snippet"})}}var T=class extends d.Plugin{constructor(){super(...arguments);this.snippetTypes=[]}async onload(){await this.loadSettings(),this.addCommand({id:"insert-callout",name:"Insert callout",editorCallback:()=>{let t=this.settings.rememberLastType?this.settings.lastUsedType:this.settings.defaultCalloutType,e=new m(this.app,{defaultType:t,autoFocusContent:this.settings.autoFocusContent,snippetTypes:this.snippetTypes}),s=e.close.bind(e);e.close=()=>{this.settings.rememberLastType&&e.type&&(this.settings.lastUsedType=e.type,this.saveSettings()),s()},e.open()}}),this.addCommand({id:"insert-callout-quick",name:"Insert callout (quick pick)",editorCallback:()=>{new C(this.app,this.snippetTypes,e=>{C.insertQuickCallout(this.app,e),this.settings.rememberLastType&&(this.settings.lastUsedType=e,this.saveSettings())}).open()}}),this.addCommand({id:"open-settings",name:"Open settings",callback:()=>{let t=this.app.setting;t.open(),t.openTabById(this.manifest.id)}}),this.addSettingTab(new S(this.app,this)),this.app.workspace.onLayoutReady(()=>{this.refreshSnippetTypes()})}async loadSettings(){this.settings=Object.assign({},w,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async refreshSnippetTypes(){this.settings.scanSnippets?this.snippetTypes=await I(this.app):this.snippetTypes=[]}},S=class extends d.PluginSettingTab{constructor(i,t){super(i,t),this.plugin=t}display(){let{containerEl:i}=this;if(i.empty(),new d.Setting(i).setName("Insertion").setHeading(),new d.Setting(i).setName("Default callout type").setDesc("The callout type pre-selected when the modal opens.").addDropdown(t=>{for(let e of f)t.addOption(e.type,e.label);for(let e of this.plugin.snippetTypes)t.addOption(e.type,e.label);t.setValue(this.plugin.settings.defaultCalloutType),t.onChange(async e=>{this.plugin.settings.defaultCalloutType=e,await this.plugin.saveSettings()})}),new d.Setting(i).setName("Remember last used type").setDesc("When enabled, the modal will default to the last callout type you inserted.").addToggle(t=>{t.setValue(this.plugin.settings.rememberLastType),t.onChange(async e=>{this.plugin.settings.rememberLastType=e,await this.plugin.saveSettings()})}),new d.Setting(i).setName("Auto-focus content").setDesc("Automatically focus the content textarea when the modal opens.").addToggle(t=>{t.setValue(this.plugin.settings.autoFocusContent),t.onChange(async e=>{this.plugin.settings.autoFocusContent=e,await this.plugin.saveSettings()})}),new d.Setting(i).setName("Detection").setHeading(),new d.Setting(i).setName("Scan CSS snippets").setDesc("Detect custom callout types defined in your enabled CSS snippet files.").addToggle(t=>{t.setValue(this.plugin.settings.scanSnippets),t.onChange(async e=>{this.plugin.settings.scanSnippets=e,await this.plugin.saveSettings(),await this.plugin.refreshSnippetTypes(),this.display()})}),this.plugin.settings.scanSnippets){let t=this.plugin.snippetTypes.length;if(t>0){new d.Setting(i).setName(`Detected types (${t})`).setDesc("Custom callout types found in your enabled CSS snippets.").addExtraButton(s=>{s.setIcon("folder-open").setTooltip("Open snippets folder").onClick(()=>{let o=`${this.app.vault.configDir}/snippets`;this.app.openWithDefaultApp(o)})});let e=i.createDiv({cls:"detected-snippet-types"});for(let s of this.plugin.snippetTypes){let o=e.createDiv({cls:"detected-snippet-type-item"}),n=o.createDiv({cls:"detected-snippet-type-icon"});(0,d.setIcon)(n,s.icon),n.style.setProperty("--callout-color",s.color),o.createSpan({text:s.label,cls:"detected-snippet-type-label"}),o.createSpan({text:s.icon,cls:"detected-snippet-type-meta"}),o.createSpan({text:`rgb(${s.color})`,cls:"detected-snippet-type-meta"})}}else new d.Setting(i).setName("No custom types detected").setDesc("No callout definitions were found in your enabled CSS snippet files.").addExtraButton(e=>{e.setIcon("folder-open").setTooltip("Open snippets folder").onClick(()=>{let s=`${this.app.vault.configDir}/snippets`;this.app.openWithDefaultApp(s)})})}}};
